/*!
 * jQuery Advanced Selectbox Plugin v0.1
 *
 * Author: Jeff Dupont
 * ==========================================================
 * Copyright 2012 iAcquire, LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ==========================================================
 */

(function(a){var b=function(b,c){this.$element=a(b),this.options=c,this.enabled=!0,this.width=this.$element.outerWidth(),this.height=this.$element.outerHeight()};b.prototype={valuebox:function(){return this.$valuebox||(this.$valuebox=a('<div class="advanced-selectbox-values"></div>').css({display:"block",cursor:"pointer"}),this.$element.before(this.$valuebox)),this.$valuebox},show:function(){var a;a=this.valuebox(),a.css({position:"absolute"}).fadeOut(),this.$element.stop(!0,!0).css({position:"absolute",zIndex:2,width:this.width,height:this.height,boxShadow:"1px 1px 2px rgba(0,0,0,0.3)"}).slideDown()},hide:function(){var a;this.getSelectedValues(),a=this.valuebox(),a.css({position:"relative"}).slideDown(),this.$element.stop(!0,!0).hide()},getSelectedValues:function(){var b=this.$element,c=this.options,d,e;d=this.valuebox(),d.empty();var f=b.find("option"+(c.filter?"[data-advanced-selectbox!='nocount']":"")+":selected"),e=f.length;e==0&&d.append(a("<div></div>").html("None")),f.each(function(b){if(b>c.show-1)return!1;var f=a(this).text().replace(/^\s*|\s*$/,"");f==""&&e==1&&(f="None"),b==c.show-1&&e>c.show&&(f="Plus <b>"+(e-c.show)+"</b> additional item"+(e>1?"s":""));var g=a("<div></div>").html(f);d.append(g)})},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},a.fn.advancedselectbox=function(c){return a.fn.advancedselectbox.init.call(this,c,b,"advancedselectbox"),this},a.fn.advancedselectbox.init=function(b,c,d){function g(e){var f=a.data(e,d);return f||(f=new c(e,a.fn.advancedselectbox.elementOptions(e,b)),a.data(e,d,f),f.hide()),f}function h(){var c=g(a(this).children("select")[0]);c.state="in",setTimeout(function(){c.state=="in"&&c.show()},b.delayIn)}function i(){var c=g(a(this).children("select")[0]);c.state="out",setTimeout(function(){c.state=="out"&&c.hide()},b.delayOut)}var e,f;return b===!0?this.data(d):typeof b=="string"?(e=this.data(d),e&&e[b](),this):(b=a.extend({},a.fn[d].defaults,b),b.exclude.length>0&&this.find("option").each(function(){var c=a(this);a.inArray(c.text(),b.exclude)>-1&&c.attr("data-advanced-selectbox","nocount")}),b.live||this.each(function(){g(this)}),f=b.live?"live":"bind",this.parent()[f]("mouseenter",h)[f]("mouseleave",i),this)},a.fn.advancedselectbox.AdvancedSelectbox=b,a.fn.advancedselectbox.elementOptions=function(b,c){return a.metadata?a.extend({},c,a(b).metadata()):c},a.fn.advancedselectbox.defaults={animate:!0,delayIn:300,delayOut:300,live:!1,show:4,filter:!0,exclude:[]}})(window.jQuery);